<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Bar Chart</title>
  <script src="node_modules/d3/build/d3.min.js"></script>
  <script src="node_modules/d3-axis/build/d3-axis.min.js"></script>
  <!-- <script src="https://d3js.org/d3.v4.min.js"></script> -->
  <style>
    .axis text {
      font: 10px sans-serif;
    }

    .axis path,
    .axis line {
      fill: none;
      stroke: #000;
      shape-rendering: crispEdges;
    }
  </style>
</head>

<body>
  <h1>US GDP</h1>
  <div id="chart"></div>
  <script>
    var myData = [10, 20, 40, 500, 360, 20, 8, 260, 1, 20, 30, 48, 600];

    var height = 500;
    var width = 500;

    var tooltip = d3.select('body').append('div')
      .style('position', 'absolute')
      .style('background', '#f4f4f4')
      .style('padding', '5 15px')
      .style('border', '1px #333 solid')
      .style('border-radius', '5px')
      .style('opacity', '0')

    var yScale = d3.scaleLinear();
    yScale.domain([0, d3.max(myData)]);
    yScale.range([0, height]);

    var xScale = d3.scaleBand();
    xScale.domain(d3.range(0, myData.length));
    xScale.range([0, width]);

    var colorScale = d3.scaleLinear();
    colorScale.domain([0, myData.length]);
    colorScale.range(['rgb(255, 0, 0)', 'rgb(0, 255, 0)']);

    var myChart;

    function draw() {
      myChart = d3.select('#chart').append('svg')
        .attr('width', width)
        .attr('height', height)
        .style('background', '#f4f4f4');

      myChart.selectAll('rect')
        .data(myData)
        .enter().append('rect')
        .style('fill', function (d, i) {
          return colorScale(i);
        })
        .attr('width', xScale.bandwidth())
        .attr('x', function (d, i) {
          return xScale(i);
        })
        .attr('height', function (d) {
          return yScale(d);
        })
        .attr('y', function (d) {
          return height - yScale(d);
        })
        .on('mouseover', (d) => {
          tooltip.transition()
            .style('opacity', 1)

          tooltip.html(d)
            .style('left', (d3.event.pageX) + 'px')
            .style('top', (d3.event.pageY) + 'px')
          d3.select(this).style('opacity', 0.5)
        })
        .on('mouseout', (d) => {
          tooltip.transition()
            .style('opacity', 0)
          d3.select(this).style('opacity', 1)
        })


      var xAxis = d3.axisBottom()
        .scale(xScale)

      var yAxis = d3.axisLeft()
        .scale(yScale);

      d3.select('#chart').append("g")
        .attr("class", "x axis")
        .attr("transform", "translate(0," + height + ")")
        .call(xAxis);

      d3.select('#chart').append("g")
        .attr("class", "x axis")
        .call(yAxis);

    }




    window.onload = function () {
      draw();
    };
  </script>
</body>

</html>